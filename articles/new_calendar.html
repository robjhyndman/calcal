<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Creating a new calendar • calcal</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Creating a new calendar">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">calcal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/new_calendar.html">Creating a new calendar</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/robjhyndman/calcal/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Creating a new calendar</h1>
                        <h4 data-toc-skip class="author">Rob J
Hyndman</h4>
            
            <h4 data-toc-skip class="date">16 July 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/robjhyndman/calcal/blob/main/vignettes/new_calendar.Rmd" class="external-link"><code>vignettes/new_calendar.Rmd</code></a></small>
      <div class="d-none name"><code>new_calendar.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/calcal/">calcal</a></span><span class="op">)</span></span></code></pre></div>
<p>Dates in the <code>calcal</code> package are stored as
<code>rdvec</code> objects which are simply vectors of Rata Die (RD)
integer values, denoting the number of days since the onset of Monday 1
January 1 CE on the Gregorian calendar. A calendar is attached to each
<code>rdvec</code> vector as an attribute, which allows for the
conversion of the RD values to the desired calendar format when
required. Converting from one calendar to another is simply a matter of
changing the calendar attribute of the vector.</p>
<p>A calendar object is an object of class <code>calendar</code> which
is a list containing the following elements:</p>
<ul>
<li>
<code>name</code>: The name of the calendar.</li>
<li>
<code>short_name</code>: A short name to use in tibble headers.</li>
<li>
<code>granularities</code>: A character vector with names of the
granularities used to define dates on the calendar. For example, for the
Gregorian calendar, the granularities are <code>"year"</code>,
<code>"month"</code>, and <code>"day"</code>).</li>
<li>
<code>validate_granularities</code>: A function to check if the
granularities are valid. For example, on the Gregorian calendar, this
function checks that the <code>month</code> is between 1 and 12, and the
<code>day</code> is valid for the given month and year.</li>
<li>
<code>format</code>: A function to output the date format as a
character vector.</li>
<li>
<code>from_rd</code>: A function to convert from RD to a list of
granularities on the new calendar.</li>
<li>
<code>to_rd</code>: A function to convert from a list of
granularities to RD values.</li>
</ul>
<p>For example, on the Gregorian calendar, here is the relevant function
to convert from a Gregorian date to RD. The <code>date</code> argument
is a list containing the <code>year</code>, <code>month</code>, and
<code>day</code> components of the date.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gregorian_to_rd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fl">365</span> <span class="op">*</span> <span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">year</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Ordinary days since day 0 to start of year</span></span>
<span>    <span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">year</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">4</span> <span class="op">-</span> <span class="co"># Adjust for leap years</span></span>
<span>    <span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">year</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">100</span> <span class="op">+</span> <span class="co"># Remove century leap years</span></span>
<span>    <span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">year</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">400</span> <span class="op">+</span> <span class="co"># Add back 400-year leap years</span></span>
<span>    <span class="op">(</span><span class="fl">367</span> <span class="op">*</span> <span class="va">date</span><span class="op">$</span><span class="va">month</span> <span class="op">-</span> <span class="fl">362</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">12</span> <span class="co"># Add days in prior months this year</span></span>
<span>  <span class="co"># Adjust if a leap year</span></span>
<span>  <span class="va">adjustment</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">month</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu">leap_year</span><span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">year</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="co"># Add days in current month</span></span>
<span>  <span class="va">result</span> <span class="op">+</span> <span class="va">adjustment</span> <span class="op">+</span> <span class="va">date</span><span class="op">$</span><span class="va">day</span></span>
<span><span class="op">}</span></span>
<span><span class="va">leap_year</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">4</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">400</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To go the other way, from RD to a Gregorian date, we need to
calculate the year, month, and day from the RD value. This is done by
calculating the year first, then determining how many days have passed
since the start of that year, and finally calculating the month and day
based on that.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rd_to_gregorian</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rd</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Calculate the year</span></span>
<span>  <span class="va">d0</span> <span class="op">&lt;-</span> <span class="va">rd</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="va">n400</span> <span class="op">&lt;-</span> <span class="va">d0</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">146097</span> <span class="co"># Completed 400-year cycles</span></span>
<span>  <span class="va">d1</span> <span class="op">&lt;-</span> <span class="va">d0</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">146097</span> <span class="co"># Prior days not in n400</span></span>
<span>  <span class="va">n100</span> <span class="op">&lt;-</span> <span class="va">d1</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">36524</span> <span class="co"># 100-year cycles not in n400</span></span>
<span>  <span class="va">d2</span> <span class="op">&lt;-</span> <span class="va">d1</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">36524</span> <span class="co"># Prior days not in n400 or n100</span></span>
<span>  <span class="va">n4</span> <span class="op">&lt;-</span> <span class="va">d2</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">1461</span> <span class="co"># 4-year cycles not in n400 or n100</span></span>
<span>  <span class="va">d3</span> <span class="op">&lt;-</span> <span class="va">d2</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">1461</span> <span class="co"># Prior days not in n400, n100, or n4</span></span>
<span>  <span class="va">n1</span> <span class="op">&lt;-</span> <span class="va">d3</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">365</span> <span class="co"># Years not in n400, n100, or n4</span></span>
<span>  <span class="va">year</span> <span class="op">&lt;-</span> <span class="fl">400</span> <span class="op">*</span> <span class="va">n400</span> <span class="op">+</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">n100</span> <span class="op">+</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">n4</span> <span class="op">+</span> <span class="va">n1</span></span>
<span>  <span class="co"># leap year adjustment</span></span>
<span>  <span class="va">year</span> <span class="op">&lt;-</span> <span class="va">year</span> <span class="op">+</span> <span class="op">!</span><span class="op">(</span><span class="va">n100</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">|</span> <span class="va">n1</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="co"># Calculate the month</span></span>
<span>  <span class="va">jan1</span> <span class="op">&lt;-</span> <span class="fu">gregorian_to_rd</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">year</span>, month <span class="op">=</span> <span class="fl">1</span>, day <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">mar1</span> <span class="op">&lt;-</span> <span class="fu">gregorian_to_rd</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">year</span>, month <span class="op">=</span> <span class="fl">3</span>, day <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">correction</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">rd</span> <span class="op">&gt;=</span> <span class="va">mar1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">-</span> <span class="fu">leap_year</span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">month</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">12</span> <span class="op">*</span> <span class="op">(</span><span class="va">rd</span> <span class="op">-</span> <span class="va">jan1</span> <span class="op">+</span> <span class="va">correction</span><span class="op">)</span> <span class="op">+</span> <span class="fl">373</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">367</span></span>
<span>  <span class="co"># Calculate the day by subtraction</span></span>
<span>  <span class="va">day1_of_month</span> <span class="op">&lt;-</span> <span class="fu">gregorian_to_rd</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">year</span>, month <span class="op">=</span> <span class="va">month</span>, day <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">day</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">rd</span> <span class="op">-</span> <span class="va">day1_of_month</span></span>
<span>  <span class="co"># Return the dates as a list</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">year</span>, month <span class="op">=</span> <span class="va">month</span>, day <span class="op">=</span> <span class="va">day</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The next function we need validates the granularities of the
calendar. For the Gregorian calendar, the following function is
used:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">validate_gregorian</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">month</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">date</span><span class="op">$</span><span class="va">month</span> <span class="op">&gt;</span> <span class="fl">12</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"month must be between 1 and 12"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">day</span> <span class="op">&gt;</span> <span class="fl">30</span> <span class="op">&amp;</span> <span class="va">date</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">11</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"day must be between 1 and 30"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">day</span> <span class="op">&gt;</span> <span class="fl">29</span> <span class="op">&amp;</span> <span class="va">date</span><span class="op">$</span><span class="va">month</span> <span class="op">==</span> <span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"days in February must be between 1 and 29"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">day</span> <span class="op">&gt;</span> <span class="fl">28</span> <span class="op">&amp;</span> <span class="va">date</span><span class="op">$</span><span class="va">month</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="fu">leap_year</span><span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"days in February must be between 1 and 28 when not a leap year"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">date</span><span class="op">$</span><span class="va">day</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">date</span><span class="op">$</span><span class="va">day</span> <span class="op">&gt;</span> <span class="fl">31</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"day must be between 1 and 31"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Finally, we need a function to format the date as a character vector.
For the Gregorian calendar, this can be done as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">format_gregorian</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rd</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">date</span> <span class="op">&lt;-</span> <span class="fu">rd_to_gregorian</span><span class="op">(</span><span class="va">rd</span><span class="op">)</span></span>
<span>  <span class="va">date</span><span class="op">[[</span><span class="st">"year"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="va">date</span><span class="op">[[</span><span class="st">"year"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">date</span><span class="op">[[</span><span class="st">"month"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">month.name</span><span class="op">[</span><span class="va">date</span><span class="op">[[</span><span class="st">"month"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">date</span><span class="op">[[</span><span class="st">"day"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="va">date</span><span class="op">[[</span><span class="st">"day"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">date</span><span class="op">[[</span><span class="st">"year"</span><span class="op">]</span><span class="op">]</span>, <span class="va">date</span><span class="op">[[</span><span class="st">"month"</span><span class="op">]</span><span class="op">]</span>, <span class="va">date</span><span class="op">[[</span><span class="st">"day"</span><span class="op">]</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To create a new Gregorian calendar object, we use the
<code>new_calendar</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Gcal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_calendar.html">new_calendar</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Gregorian"</span>,</span>
<span>  short_name <span class="op">=</span> <span class="st">"G"</span>,</span>
<span>  granularities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span><span class="op">)</span>,</span>
<span>  validate_granularities <span class="op">=</span> <span class="va">validate_gregorian</span>,</span>
<span>  format <span class="op">=</span> <span class="va">format_gregorian</span>,</span>
<span>  from_rd <span class="op">=</span> <span class="va">rd_to_gregorian</span>,</span>
<span>  to_rd <span class="op">=</span> <span class="va">gregorian_to_rd</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then we can use the <code>Gcal</code> calendar to create
<code>rdvec</code> vectors:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/new_date.html">as_date</a></span><span class="op">(</span><span class="st">"2026-01-01"</span>, calendar <span class="op">=</span> <span class="va">Gcal</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="co">#&gt; &lt;Gregorian[11]&gt;</span></span>
<span><span class="co">#&gt;  [1] 2026-January-01 2026-January-02 2026-January-03 2026-January-04</span></span>
<span><span class="co">#&gt;  [5] 2026-January-05 2026-January-06 2026-January-07 2026-January-08</span></span>
<span><span class="co">#&gt;  [9] 2026-January-09 2026-January-10 2026-January-11</span></span>
<span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_date.html">new_date</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2025</span>, month <span class="op">=</span> <span class="fl">7</span>, day <span class="op">=</span> <span class="fl">18</span><span class="op">:</span><span class="fl">24</span>, calendar <span class="op">=</span> <span class="va">Gcal</span><span class="op">)</span></span>
<span><span class="va">nd</span></span>
<span><span class="co">#&gt; &lt;Gregorian[7]&gt;</span></span>
<span><span class="co">#&gt; [1] 2025-July-18 2025-July-19 2025-July-20 2025-July-21 2025-July-22</span></span>
<span><span class="co">#&gt; [6] 2025-July-23 2025-July-24</span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  greg <span class="op">=</span> <span class="va">nd</span>,</span>
<span>  RD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">nd</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 2</span></span></span>
<span><span class="co">#&gt;           greg     RD</span></span>
<span><span class="co">#&gt;            <span style="color: #949494; font-style: italic;">&lt;G&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2025-July-18 <span style="text-decoration: underline;">739</span>450</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2025-July-19 <span style="text-decoration: underline;">739</span>451</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2025-July-20 <span style="text-decoration: underline;">739</span>452</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2025-July-21 <span style="text-decoration: underline;">739</span>453</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2025-July-22 <span style="text-decoration: underline;">739</span>454</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2025-July-23 <span style="text-decoration: underline;">739</span>455</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 2025-July-24 <span style="text-decoration: underline;">739</span>456</span></span></code></pre></div>
<p>Existing helper functions will also work with the new calendar. For
example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/granularities.html">granularity_names</a></span><span class="op">(</span><span class="va">Gcal</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "year"  "month" "day"</span></span>
<span><span class="fu"><a href="../reference/granularities.html">granularity</a></span><span class="op">(</span><span class="va">nd</span>, <span class="st">"day"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 18 19 20 21 22 23 24</span></span>
<span><span class="fu"><a href="../reference/gregorian-parts.html">day_of_week</a></span><span class="op">(</span><span class="va">nd</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Friday"    "Saturday"  "Sunday"    "Monday"    "Tuesday"   "Wednesday"</span></span>
<span><span class="co">#&gt; [7] "Thursday"</span></span>
<span><span class="fu"><a href="../reference/gregorian-parts.html">week_of_year</a></span><span class="op">(</span><span class="va">nd</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 29 29 29 30 30 30 30</span></span>
<span><span class="fu"><a href="../reference/gregorian-parts.html">month_of_year</a></span><span class="op">(</span><span class="va">nd</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7 7 7 7 7 7 7</span></span></code></pre></div>
<p>The dates on this new calendar can be converted to any other defined
calendar. For example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/new_date.html">as_date</a></span><span class="op">(</span><span class="va">nd</span>, calendar <span class="op">=</span> <span class="va">cal_hebrew</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;hebrew[7]&gt;</span></span>
<span><span class="co">#&gt; [1] 5785-Tammuz-22 5785-Tammuz-23 5785-Tammuz-24 5785-Tammuz-25 5785-Tammuz-26</span></span>
<span><span class="co">#&gt; [6] 5785-Tammuz-27 5785-Tammuz-28</span></span>
<span><span class="fu"><a href="../reference/iso.html">as_iso</a></span><span class="op">(</span><span class="va">nd</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;iso[7]&gt;</span></span>
<span><span class="co">#&gt; [1] 2025-29-05 2025-29-06 2025-29-07 2025-30-01 2025-30-02 2025-30-03 2025-30-04</span></span></code></pre></div>
<p>If you want to regularly convert dates on other calendars to your new
calendar, you can create an <code>as_&lt;calendar_name&gt;</code>
function. For example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">as_Gregorian</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/new_date.html">as_date</a></span><span class="op">(</span><span class="va">date</span>, calendar <span class="op">=</span> <span class="va">Gcal</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">as_Gregorian</span><span class="op">(</span><span class="st">"2026-01-01"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;Gregorian[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 2026-January-01</span></span></code></pre></div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rob Hyndman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
